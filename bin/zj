#!/bin/bash
# zj - Zellij session preset manager

LAYOUT_DIR="$HOME/.config/zellij/layouts"

# No arguments: list available presets
if [ -z "$1" ]; then
    echo "Available presets:"
    for layout in "$LAYOUT_DIR"/*.kdl; do
        [ -f "$layout" ] || continue
        name=$(basename "$layout" .kdl)
        if zellij list-sessions --short 2>/dev/null | grep -qx "$name"; then
            echo "  $name (active)"
        else
            echo "  $name"
        fi
    done
    echo ""
    echo "Usage: zj <preset-name>"
    exit 0
fi

PRESET="$1"
LAYOUT="$LAYOUT_DIR/$PRESET.kdl"

# Validate layout exists
if [ ! -f "$LAYOUT" ]; then
    echo "Error: Layout '$PRESET' not found"
    echo "Run 'zj' to see available presets"
    exit 1
fi

# Attach if session exists, otherwise create
if zellij list-sessions --short 2>/dev/null | grep -qx "$PRESET"; then
    zellij attach "$PRESET"
else
    zellij -s "$PRESET" --layout "$LAYOUT"
fi
